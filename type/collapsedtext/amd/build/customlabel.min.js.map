{"version":3,"file":"customlabel.min.js","sources":["../src/customlabel.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// jshint unused: true, undef:true\n\ndefine(['jquery', 'core/log', 'core/config'], function($, log, cfg) {\n\n    customboxcollapsed = {\n\n        init: function() {\n            $('.custombox-collapsedtext-open-all').bind('click', this.openall);\n            $('.custombox-collapsedtext-close-all').bind('click', this.closeall);\n            $('.custombox-collapsedtext-toggle').bind('click', this.togglestate);\n            $('.custombox-collapsedtext-caption').bind('click', this.togglestateproxy);\n\n            log.debug('AMD customlabel collapsedtext initialized.');\n        },\n\n        openall: function() {\n\n            var that = $(this);\n\n            var id = that.attr('id').replace('custombox-collapsedtext-open-all-', '');\n            var collapsehandleclass = '.custombox-collapsedtext-toggle-' + id;\n            var collapseclass = '.custombox-collapsedtext-panel-' + id\n            $(collapseclass).removeClass('collapsed');\n            $(collapsehandleclass + ' img').each(function() {\n                var src = $(this).attr('src');\n                $(this).attr('src', src.replace('closed', 'open'));\n            });\n\n            // Send data to completion.\n            var url = cfg.wwwroot + '/mod/customlabel/type/collapsedtext/ajax/service.php';\n            url += '?what=complete';\n            url += '&cmid=' + id;\n\n            $.get(url);\n        },\n\n        closeall: function(e) {\n\n            var that = $(this);\n\n            var id = that.attr('id').replace('custombox-collapsedtext-close-all-', '');\n            var collapsehandleclass = '.custombox-collapsedtext-toggle-' + id;\n            var collapseclass = '.custombox-collapsedtext-panel-' + id\n            $(collapseclass).addClass('collapsed');\n            $(collapsehandleclass + ' img').each(function() {\n                var src = $(this).attr('src');\n                $(this).attr('src', src.replace('open', 'closed'));\n            });\n        },\n\n        togglestate: function(e) {\n            var that = $(this);\n            var toggle = that.hasClass('is-toggle');\n\n            var fullid = that.attr('id').replace('custombox-collapsedtext-toggle-', '');\n            var parts = fullid.split('-');\n            var cmid = parts.shift();\n            var itemid = parts.shift();\n            var collapsehandleid = '#custombox-collapsedtext-toggle-' + fullid;\n            var collapseid = '#custombox-collapsedtext-panel-' + fullid;\n            var collapsehandleclass = '.custombox-collapsedtext-toggle-' + cmid;\n            var collapseclass = '.custombox-collapsedtext-panel-' + cmid;\n\n            if (toggle) {\n                if ($(collapseid).hasClass('collapsed')) {\n                    $(collapseid).removeClass('collapsed');\n                    var src = $(collapsehandleid + ' img').attr('src');\n                    $(collapsehandleid + ' img').attr('src', src.replace('closed', 'open'));\n                    customboxcollapsed.sendcompletion(cmid, itemid);\n                } else {\n                    $(collapseid).addClass('collapsed');\n                    var src = $(collapsehandleid + ' img').attr('src');\n                    $(collapsehandleid + ' img').attr('src', src.replace('open', 'closed'));\n                }\n            } else {\n                // Accordion behaviour. (close all before open).\n                $(collapseclass).addClass('collapsed');\n                $(collapseid).removeClass('collapsed');\n                customboxcollapsed.sendcompletion(cmid, itemid);\n\n                $(collapsehandleclass + ' img').each(function() {\n                    var src = $(this).attr('src');\n                    $(this).attr('src', src.replace('open', 'closed'));\n                });\n                var src = $(collapsehandleid + ' img').attr('src');\n                $(collapsehandleid + ' img').attr('src', src.replace('closed', 'open'));\n            }\n\n            e.preventDefault();\n        },\n\n        togglestateproxy: function() {\n\n            var that = $(this);\n\n            var toggleid = that.attr('id').replace('custombox-collapsedtext-caption-', 'custombox-collapsedtext-toggle-');\n            $('#' + toggleid).trigger('click');\n\n        },\n\n        sendcompletion: function(cmid, item) {\n            // Send data to completion.\n            var url = cfg.wwwroot + '/mod/customlabel/type/collapsedtext/ajax/service.php';\n            url += '?what=open';\n            url += '&cmid=' + cmid;\n            url += '&item=' + item;\n\n            $.get(url);\n        }\n    };\n\n    return customboxcollapsed;\n\n});"],"names":["define","$","log","cfg","customboxcollapsed","init","bind","this","openall","closeall","togglestate","togglestateproxy","debug","id","attr","replace","collapsehandleclass","removeClass","each","src","url","wwwroot","get","e","addClass","that","toggle","hasClass","fullid","parts","split","cmid","shift","itemid","collapsehandleid","collapseid","collapseclass","sendcompletion","preventDefault","toggleid","trigger","item"],"mappings":"AAiBAA,mDAAO,CAAC,SAAU,WAAY,gBAAgB,SAASC,EAAGC,IAAKC,YAE3DC,mBAAqB,CAEjBC,KAAM,WACFJ,EAAE,qCAAqCK,KAAK,QAASC,KAAKC,SAC1DP,EAAE,sCAAsCK,KAAK,QAASC,KAAKE,UAC3DR,EAAE,mCAAmCK,KAAK,QAASC,KAAKG,aACxDT,EAAE,oCAAoCK,KAAK,QAASC,KAAKI,kBAEzDT,IAAIU,MAAM,+CAGdJ,QAAS,eAIDK,GAFOZ,EAAEM,MAECO,KAAK,MAAMC,QAAQ,oCAAqC,IAClEC,oBAAsB,mCAAqCH,GAE/DZ,EADoB,kCAAoCY,IACvCI,YAAY,aAC7BhB,EAAEe,oBAAsB,QAAQE,MAAK,eAC7BC,IAAMlB,EAAEM,MAAMO,KAAK,OACvBb,EAAEM,MAAMO,KAAK,MAAOK,IAAIJ,QAAQ,SAAU,gBAI1CK,IAAMjB,IAAIkB,QAAU,uDACxBD,KAAO,iBACPA,KAAO,SAAWP,GAElBZ,EAAEqB,IAAIF,MAGVX,SAAU,SAASc,OAIXV,GAFOZ,EAAEM,MAECO,KAAK,MAAMC,QAAQ,qCAAsC,IACnEC,oBAAsB,mCAAqCH,GAE/DZ,EADoB,kCAAoCY,IACvCW,SAAS,aAC1BvB,EAAEe,oBAAsB,QAAQE,MAAK,eAC7BC,IAAMlB,EAAEM,MAAMO,KAAK,OACvBb,EAAEM,MAAMO,KAAK,MAAOK,IAAIJ,QAAQ,OAAQ,eAIhDL,YAAa,SAASa,OACdE,KAAOxB,EAAEM,MACTmB,OAASD,KAAKE,SAAS,aAEvBC,OAASH,KAAKX,KAAK,MAAMC,QAAQ,kCAAmC,IACpEc,MAAQD,OAAOE,MAAM,KACrBC,KAAOF,MAAMG,QACbC,OAASJ,MAAMG,QACfE,iBAAmB,mCAAqCN,OACxDO,WAAa,kCAAoCP,OACjDZ,oBAAsB,mCAAqCe,KAC3DK,cAAgB,kCAAoCL,QAEpDL,UACIzB,EAAEkC,YAAYR,SAAS,aAAc,CACrC1B,EAAEkC,YAAYlB,YAAY,iBACtBE,IAAMlB,EAAEiC,iBAAmB,QAAQpB,KAAK,OAC5Cb,EAAEiC,iBAAmB,QAAQpB,KAAK,MAAOK,IAAIJ,QAAQ,SAAU,SAC/DX,mBAAmBiC,eAAeN,KAAME,YACrC,CACHhC,EAAEkC,YAAYX,SAAS,aACnBL,IAAMlB,EAAEiC,iBAAmB,QAAQpB,KAAK,OAC5Cb,EAAEiC,iBAAmB,QAAQpB,KAAK,MAAOK,IAAIJ,QAAQ,OAAQ,eAE9D,CAEHd,EAAEmC,eAAeZ,SAAS,aAC1BvB,EAAEkC,YAAYlB,YAAY,aAC1Bb,mBAAmBiC,eAAeN,KAAME,QAExChC,EAAEe,oBAAsB,QAAQE,MAAK,eAC7BC,IAAMlB,EAAEM,MAAMO,KAAK,OACvBb,EAAEM,MAAMO,KAAK,MAAOK,IAAIJ,QAAQ,OAAQ,cAExCI,IAAMlB,EAAEiC,iBAAmB,QAAQpB,KAAK,OAC5Cb,EAAEiC,iBAAmB,QAAQpB,KAAK,MAAOK,IAAIJ,QAAQ,SAAU,SAGnEQ,EAAEe,kBAGN3B,iBAAkB,eAIV4B,SAFOtC,EAAEM,MAEOO,KAAK,MAAMC,QAAQ,mCAAoC,mCAC3Ed,EAAE,IAAMsC,UAAUC,QAAQ,UAI9BH,eAAgB,SAASN,KAAMU,UAEvBrB,IAAMjB,IAAIkB,QAAU,uDACxBD,KAAO,aACPA,KAAO,SAAWW,KAClBX,KAAO,SAAWqB,KAElBxC,EAAEqB,IAAIF,OAIPhB,kBAEV"}