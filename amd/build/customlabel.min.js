<<<<<<< HEAD
define(["jquery","core/config","core/str","core/log"],function(a,b,c,d){var e={strs:[],context:[],init:function(b){e.context=b;var f=[{key:"changetypeadvice",component:"customlabel"}];c.get_strings(f).done(function(a){e.strs=a}),a(".customctl").bind("click",this.togglecustom),a(".customctl-string").bind("click",this.togglecustomstring),a(".customlabel-constraint").bind("click",this.constraint_colorize),a(".mform").on("change",'select[data-constrained = "1"]',this.applyconstraints),a('select[data-constrained = "1"]').prop("disabled",null),a("#id_labelclass").bind("change",this.typechangesubmit),a("#id_level0").trigger("change"),a("#id_level1").trigger("change"),a("#id_level2").trigger("change"),d.debug("AMD Customlabels initialized")},togglecustom:function(){var c=a(this),d=c.attr("id").replace("customctl-","custom-thumb-"),e=c.attr("id").replace("customctl-","custom-");a("#"+e).hasClass("hidden")?(a("#"+e).removeClass("hidden"),a("#"+d).removeClass("hidden"),c.attr("src",b.wwwroot+"/mod/customlabel/pix/plus.gif")):(a("#"+e).addClass("hidden"),a("#"+d).addClass("hidden"),c.attr("src",b.wwwroot+"/mod/customlabel/pix/minus.gif"))},togglecustomstring:function(){var b=a(this),c=b.attr("id").replace("customctl-","custom-"),d=b.attr("data-labels").split(",");a("#"+c).hasClass("hidden")?(a("#"+c).removeClass("hidden"),b.html(d[1])):(a("#"+c).addClass("hidden"),b.html(d[2]))},constraint_colorize:function(){var b=a(this);1==b.val()?this.addclass("green"):this.addclass("red")},applyconstraints:function(){var c=a(this),e=c.attr("data-constraints"),f=c.attr("data-label-type"),g=c.attr("data-cmid");d.debug("Applying constraints on "+c.attr("id"));var h=0;if(""===e)return void d.debug("No targets ");var i=e.split(","),j=[],k=a("#"+c.attr("id")+" option");k.each(function(){a(this).prop("selected")&&j.push(a(this).val())});var l=j.join(","),m=[],n=[],o=[],p=function(){m[h].push(a(this).val()),n[i[q]].push(a(this).val())};for(var q in i){n[i[q]]=[];var r="level"+i[q];m[h]=r,o.push(a("#id_"+r).first()),h++,m[h]=[];var s=a("#id_"+r+" option:selected");s.each(p),h++}a.each(o,function(a,b){b.prop("disabled",!0)});var t=encodeURIComponent(JSON.stringify(m)),u=b.wwwroot+"/mod/customlabel/ajax/applyconstraints.php?";u+="selector="+c.attr("name"),u+="&targets="+e,u+="&type="+f,u+="&cmid="+g,u+="&constraints="+l,u+="&selection="+t,a.get(u,"",function(b){var c=b,f=e.split(",");for(var g in f)if(c[f[g]]){var h='<input type="hidden" name="level'+f[g];h+='" value="_qf__force_multiselect_submission">',h+=c[f[g]],d.debug("Rewriting select #fitem_id_level"+f[g]+" .felement"),a("#fitem_id_level"+f[g]+" .felement").html(h)}for(var i in n){var j=n[i][0];j>0&&a("#id_level"+i+" option[value="+j+"]").attr("selected",!0)}a('select[data-constrained = "1"]').prop("disabled",!1)},"json")},typechangesubmit:function(){var c,d=a(this);confirm(e.strs[0])&&(e.context.updatelabelid?(c=b.wwwroot+"/mod/customlabel/mod.php?",c+="update="+e.context.updatelabelid,c+="&sesskey="+b.sesskey,c+="&sr="+e.context.section,c+="&returntomod="+e.context.returntomod,c+="&type="+d.val()):(c=b.wwwroot+"/course/mod.php?",c+="id="+e.context.courseid,c+="&section="+e.context.section,c+="&sesskey="+b.sesskey,c+="&add=customlabel",c+="&returntomod="+e.context.returntomod,c+="&type="+d.val()),document.location.href=c)}};return e});
=======
define ("mod_customlabel/customlabel",["jquery","core/config","core/str","core/log"],function(a,b,c,d){var e={strs:[],context:[],init:function init(b){e.context=b;c.get_strings([{key:"changetypeadvice",component:"customlabel"}]).done(function(a){e.strs=a});a(".customctl").bind("click",this.togglecustom);a(".customctl-string").bind("click",this.togglecustomstring);a(".customlabel-constraint").bind("click",this.constraint_colorize);a("select.constrained").bind("change",this.applyconstraints);a("select.constrained").prop("disabled",null);a("#id_labelclass").bind("change",this.typechangesubmit);a("#id_level0").trigger("change");a("#id_level1").trigger("change");a("#id_level2").trigger("change");d.debug("AMD Customlabels initialized")},rebindconstraints:function rebindconstraints(){a("select.constrained").off("change");a("select.constrained").bind("change",this.applyconstraints);d.debug("AMD Customlabels constraints rebound")},togglecustom:function togglecustom(){var c=a(this),d=c.attr("id").replace("customctl-","custom-thumb-"),e=c.attr("id").replace("customctl-","custom-");if(a("#"+e).hasClass("hidden")){a("#"+e).removeClass("hidden");a("#"+d).removeClass("hidden");c.attr("src",b.wwwroot+"/mod/customlabel/pix/plus.gif")}else{a("#"+e).addClass("hidden");a("#"+d).addClass("hidden");c.attr("src",b.wwwroot+"/mod/customlabel/pix/minus.gif")}},togglecustomstring:function togglecustomstring(){var b=a(this),c=b.attr("id").replace("customctl-","custom-"),d=b.attr("data").split(",");if(a("#"+c).hasClass("hidden")){a("#"+c).removeClass("hidden");b.html(d[1])}else{a("#"+c).addClass("hidden");b.html(d[2])}},constraint_colorize:function constraint_colorize(){var b=a(this);if(1==b.val()){this.addclass("green")}else{this.addclass("red")}},applyconstraints:function applyconstraints(){var c=a(this),f=c.attr("data-constraints"),g=c.attr("data-label-type"),h=c.attr("data-cmid");d.debug("Applying constraints on "+c.attr("id"));var j=0;if(""===f){d.debug("No targets ");return}var k=f.split(","),l=[],m=a("#"+c.attr("id")+" option");m.each(function(){if(a(this).prop("selected")){l.push(a(this).val())}});var n=l.join(","),o=[],p=[],q=[],r=function(){o[j].push(a(this).val());p[k[s]].push(a(this).val())};for(var s in k){p[k[s]]=[];var t="level"+k[s];o[j]=t;q.push(a("#id_"+t).first());j++;o[j]=[];var u=a("#id_"+t+" option:selected");u.each(r);j++}a.each(q,function(a,b){b.prop("disabled",!0)});var v=encodeURIComponent(JSON.stringify(o)),w=b.wwwroot+"/mod/customlabel/ajax/applyconstraints.php?";w+="selector="+c.attr("name");w+="&targets="+f;w+="&type="+g;w+="&cmid="+h;w+="&constraints="+n;w+="&selection="+v;a.get(w,"",function(b){var c=b,d=f.split(",");for(var g in d){if(c[d[g]]){var h="<input type=\"hidden\" name=\"level"+d[g];h+="\" value=\"_qf__force_multiselect_submission\">";h+=c[d[g]];a("#fitem_id_level"+d[g]+" .felement.fselect").html(h)}}e.rebindconstraints();for(var i in p){var j=p[i][0];if(0<j){a("#id_level"+i+" option[value="+j+"]").attr("selected",!0)}}a(".select.constrained").prop("disabled",!1)},"json")},typechangesubmit:function typechangesubmit(){var c=a(this),d;if(confirm(e.strs[0])){if(!e.context.updatelabelid){d=b.wwwroot+"/course/mod.php?";d+="id="+e.context.courseid;d+="&section="+e.context.section;d+="&sesskey="+b.sesskey;d+="&add=customlabel";d+="&returntomod="+e.context.returntomod;d+="&type="+c.val()}else{d=b.wwwroot+"/mod/customlabel/mod.php?";d+="update="+e.context.updatelabelid;d+="&sesskey="+b.sesskey;d+="&sr="+e.context.section;d+="&returntomod="+e.context.returntomod;d+="&type="+c.val()}document.location.href=d}}};return e});
//# sourceMappingURL=customlabel.min.js.map
>>>>>>> 3ffadab7e7686124b23744b85fce919514a24c9e
