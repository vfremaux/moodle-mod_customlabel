define("mod_customlabel/pro",["jquery","core/log","core/config"],(function($,log,cfg){var customlabelpro={component:"mod_customlabel",shortcomponent:"customlabel",componentpath:"mod/customlabel",init:function(){var licensekeyid="#id_s_"+customlabelpro.shortcomponent+"_licensekey";$(licensekeyid).bind("change",this.check_product_key),$(licensekeyid).trigger("change"),log.debug("AMD Pro js initialized for "+customlabelpro.component+" system")},check_product_key:function(){var licensekeyid="#id_s_"+customlabelpro.shortcomponent+"_licensekey",that=$(this),productkey=that.val().replace(/-/g,""),payload=productkey.substr(0,14),crc=productkey.substr(14,2),calculated=customlabelpro.checksum(payload),validicon=' <img class="icon" src="'+cfg.wwwroot+'/pix/i/valid.svg">',cautionicon=' <img class="icon" src="'+cfg.wwwroot+'/pix/i/warning.svg">',invalidicon=' <img class="icon" src="'+cfg.wwwroot+'/pix/i/invalid.svg">',waiticon=' <img class="icon" src="'+cfg.wwwroot+'/pix/i/loading.svg">';if(crc===calculated){var url=cfg.wwwroot+"/"+customlabelpro.componentpath+"/pro/ajax/services.php?";url+="what=license",url+="&service=check",url+="&customerkey="+that.val(),url+="&provider="+$("#id_s_"+customlabelpro.shortcomponent+"_licenseprovider").val(),$(licensekeyid+" + img").remove(),$(licensekeyid).after(waiticon),$.get(url,(function(data){data.match(/(SET|CHECK) OK/)?data.match(/-\d+.*$/)?($(licensekeyid+" + img").remove(),$(licensekeyid).after(cautionicon)):($(licensekeyid+" + img").remove(),$(licensekeyid).after(validicon)):($(licensekeyid+" + img").remove(),$(licensekeyid).after(invalidicon))}),"html")}else $(licensekeyid+" + img").remove(),$(licensekeyid).after(cautionicon)},checksum:function(keypayload){var crcrangearr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),crccount=crcrangearr.length,chars=keypayload.split(""),crc=0;for(var ch in chars){crc+=chars[ch].charCodeAt(0)}var crc2=Math.floor(crc/crccount)%crccount;return""+crcrangearr[crc%crccount]+crcrangearr[crc2]}};return customlabelpro}));

//# sourceMappingURL=pro.min.js.map